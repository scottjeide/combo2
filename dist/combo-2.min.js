/*! Combo2 0.3
 * Copyright (c) 2016 Stephen Rolfe Nielsen
 *
 * https://github.com/srolfe26/combo2
 *
 * @license MIT 2016 Stephen Rolfe Nielsen
 */ 

Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var n,i;if(null==this)throw new TypeError(" this is null or not defined");var r=Object(this),a=r.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(n=t),i=0;a>i;){var o;i in r&&(o=r[i],e.call(n,o,i,r)),i++}}),function(){"use strict";var e=Array.prototype.slice;try{e.call(document.documentElement)}catch(t){Array.prototype.slice=function(t,n){if(n="undefined"!=typeof n?n:this.length,"[object Array]"===Object.prototype.toString.call(this))return e.call(this,t,n);var i,r,a=[],o=this.length,l=t||0;l=l>=0?l:Math.max(0,o+l);var s="number"==typeof n?Math.min(n,o):o;if(0>n&&(s=o+n),r=s-l,r>0)if(a=new Array(r),this.charAt)for(i=0;r>i;i++)a[i]=this.charAt(l+i);else for(i=0;r>i;i++)a[i]=this[l+i];return a}}}(),function(){if(!Object.defineProperty||!function(){try{return Object.defineProperty({},"x",{}),!0}catch(e){return!1}}()){var e=Object.defineProperty;Object.defineProperty=function(t,n,i){if(e)try{return e(t,n,i)}catch(r){}if(t!==Object(t))throw TypeError("Object.defineProperty called on non-object");return Object.prototype.__defineGetter__&&"get"in i&&Object.prototype.__defineGetter__.call(t,n,i.get),Object.prototype.__defineSetter__&&"set"in i&&Object.prototype.__defineSetter__.call(t,n,i.set),"value"in i&&(t[n]=i.value),t}}}(),!function(e,t,n){"undefined"!=typeof module&&module.exports?module.exports=n():e[t]=n()}(this,"verge",function(){function e(){return{width:c(),height:d()}}function t(e,t){var n={};return t=+t||0,n.width=(n.right=e.right+t)-(n.left=e.left-t),n.height=(n.bottom=e.bottom+t)-(n.top=e.top-t),n}function n(e,n){return e=e&&!e.nodeType?e[0]:e,e&&1===e.nodeType?t(e.getBoundingClientRect(),n):!1}function i(t){t=null==t?e():1===t.nodeType?n(t):t;var i=t.height,r=t.width;return i="function"==typeof i?i.call(t):i,r="function"==typeof r?r.call(t):r,r/i}var r={},a="undefined"!=typeof window&&window,o="undefined"!=typeof document&&document,l=o&&o.documentElement,s=a.matchMedia||a.msMatchMedia,u=s?function(e){return!!s.call(a,e).matches}:function(){return!1},c=r.viewportW=function(){var e=l.clientWidth,t=a.innerWidth;return t>e?t:e},d=r.viewportH=function(){var e=l.clientHeight,t=a.innerHeight;return t>e?t:e};return r.mq=u,r.matchMedia=s?function(){return s.apply(a,arguments)}:function(){return{}},r.viewport=e,r.scrollX=function(){return a.pageXOffset||l.scrollLeft},r.scrollY=function(){return a.pageYOffset||l.scrollTop},r.rectangle=n,r.aspect=i,r.inX=function(e,t){var i=n(e,t);return!!i&&i.right>=0&&i.left<=c()},r.inY=function(e,t){var i=n(e,t);return!!i&&i.bottom>=0&&i.top<=d()},r.inViewport=function(e,t){var i=n(e,t);return!!i&&i.bottom>=0&&i.right>=0&&i.top<=d()&&i.left<=c()},r}),jQuery.extend(verge);var Wui=Wui||{};Wui.id=function(e){return e=e||"wui",e+"-"+(Wui.idCounter=~~++Wui.idCounter)},Wui.maxZ=function(){var e=arguments[0]instanceof jQuery?arguments[0][0]:arguments[0],t=$("body *"),n=t.length<2500?t:$('body > *, [style*="z-index"]'),i=Math.max.apply(null,$.map(n,function(t){return"static"!=$(t).css("position")&&t!=e?parseInt($(t).css("z-index"))||0:void 0}));return($.isNumeric(i)?i:0)+1},Wui.isPercent=function(e){return e=String(e),-1!=e.indexOf("%")&&$.isNumeric(parseFloat(e))},Wui.getScrollbarWidth=function(){var e,t;return void 0===Wui.scrollbarWidth&&(e=$('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body"),t=e.children(),Wui.scrollbarWidth=t.innerWidth()-t.height(99).innerWidth(),e.remove()),Wui.scrollbarWidth},Wui.getStylesForElement=function(e){var t={};Array.prototype.slice.call(document.styleSheets).forEach(function(n){n.rules&&Array.prototype.slice.call(n.rules).forEach(function(i){n.rule&&i.selectorText.split(",").forEach(function(n){if(e.matches(n))for(var r=0;r<i.style.length;++r){var a=i.style[r];t[a]=i.style[a]}})})});var n=e.style;return $.each(n,function(e,i){t[i]=n[i]}),t},Wui.parseSelect=function(e){var t=[],n=$(e).find("option");return n.each(function(e,n){var i=$(n),r=i.parent("optgroup"),a=r.prop("disabled")||i.prop("disabled");t.push({element:i,index:e,value:a?null:i.val(),label:i.text(),optgroup:r.attr("label")||"",disabled:a})}),t},Wui.percentToPixels=function(e,t,n){var i=e.parent(),r=i[0]===$(window)[0]||i[0]===$("html")[0]||i[0]===$("body")[0],a=r?"height"==n?$.viewportH():$.viewportW():i[n]();return Math.floor(parseFloat(t)/100*a)},Wui.positionItem=function(e,t){var n,i=e[0].getBoundingClientRect(),r=i.top,a=t.outerWidth(),o=i.top,l=$.viewportH()-o-e.outerHeight(),s=l>o,u=i.left+e.outerWidth()-a>0;t.css({"max-height":(s?l:o)-15}),n=t.outerHeight(),r=s?r+e.outerHeight():r-($.isNumeric(n)?n:t.outerHeight()),t.css({left:u?i.left+e.outerWidth()-a:i.left,top:r,position:"fixed",zIndex:Wui.maxZ(t)})},Wui.unwrapData=function(e){var t=this,n=t.hasOwnProperty("dataContainer")?t.dataContainer:Wui.Data.prototype.dataContainer,i=t.hasOwnProperty("totalContainer")?t.totalContainer:Wui.Data.prototype.totalContainer,r=n&&e[n]?e[n]:e,a=i&&e[i]?e[i]:r.length;return{data:r,total:a}},Wui.Data=function(e){$.extend(this,{data:[],identity:null,name:null,params:{},url:null,ajaxConfig:{},total:0},e)},Wui.Data.prototype={dataContainer:null,totalContainer:null,dataChanged:function(){},dataEach:function(e){for(var t=0;t<this.data.length&&e(this.data[t],t)!==!1;t++);return!0},loadData:function(){var e=this,t=$.extend({data:e.params,dataType:"json",success:function(){e.success.apply(e,arguments)},error:function(){e.failure.apply(e,arguments)}},e.ajaxConfig),n=e.setParams.apply(e,arguments),i=e.beforeLoad.apply(e,arguments);return n!==!1&&i!==!1?(e.lastRequest&&4!=e.lastRequest.readyState&&e.lastRequest.abort(),e.lastRequest=$.ajax(e.url,t),e.lastRequest):$.Deferred().reject()},setParams:function(e){e&&"object"==typeof e&&$.extend(this.params,e)},setData:function(e,t){var n=this;n.beforeSet(e),n.data=n.processData(e),n.total=$.isNumeric(t)?t:n.data?n.data.length:0,n.fireDataChanged()},fireDataChanged:function(){var e=this,t=e.name||"w121-data";e.dataChanged(e.data),$(document).trigger($.Event("datachanged."+t),[t,e]).trigger($.Event("datachanged"),[t,e]),e.afterSet(e.data)},beforeLoad:function(){},afterSet:function(){},beforeSet:function(){},success:function(e){var t=this,n=Wui.unwrapData.call(t,e);t.onSuccess(e),t.setData(n.data,n.total)},onSuccess:function(){},onFailure:function(){},failure:function(e){this.onFailure(e)},processData:function(e){return e},push:function(){var e=Array.prototype.push.apply(this.data||(this.data=[]),arguments);return this.total=this.data.length,this.fireDataChanged(),e},splice:function(){var e=Array.prototype.splice.apply(this.data||(this.data=[]),arguments);return this.total=this.data.length,this.fireDataChanged(),e}},Wui.Smarty=function(e){$.extend(this,{html:"",compiled:null,build:[],__s:""},e)},Wui.Smarty.prototype={applyFlags:function(e,t){function n(e,t){var n=i.build[i.build.length-1];n.fn=n.fn||[],n.params=n.params||[],n.fn.push(e),n.params.push($.extend(!0,[],t))}for(var i=this,r=0;r<t.length;r++){for(var a,o=t[r].split(":"),l=1;l<o.length;l++)o[l]=i.trimSpecial(o[l],"\"'");a=o.shift(),"function"==a?(n("js_function",o),e=i.js_function.apply(i,o)):("default"==a&&(a="defaultVal"),"function"!=typeof i[a]?new Error("wui-smarty.js - Unsupported flag: '"+a+"'."):(n(a,o),o.splice(0,0,e),e=i[a].apply(i,o)))}return e},capitalize:function(e){return String(e).replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})},chain:function(e,t){var n=this;return t.splice(0,0,n.__s),n.__s=n[e].apply(n,t),n},compile:function(){function e(e){return"['"+e.join("','")+"']"}for(var t=this,n='var me = this, retString = "";',i=0;i<t.build.length;i++){var r=t.build[i];if($.isPlainObject(r)){if(r.key.length>0?n+="me.__s = me.lookup(rec, '"+r.key+"');":"undefined"!=typeof r.fn&&(n+="me.__s = me."+r.fn.shift()+".apply(me, "+e(r.params.shift())+");"),"undefined"!=typeof r.fn&&r.fn.length>0){n+="me";for(var a=0;a<r.fn.length;a++)n+=".chain('"+r.fn[a]+"',"+e(r.params[a])+")";n+=";"}n+="retString += me.__s;"}else n+="retString += '"+t.escape(r,"javascript")+"';"}return n+="return retString;",Function.apply(null,["rec",n])},defaultVal:function(e,t){return e?e:t},escapeHTML:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},escapeJS:{"\\":"\\\\","'":"\\'",'"':'\\"',"\r":"\\r","\n":"\\n","</":"</"},escape:function(e,t,n){n=n||!1;var i=this,r={html:function(){var t=i.escapeHTML,r=n?i.invert(t):t,a=new RegExp("["+i.getKeys(r).join("").replace(/\//,"\\/")+"]","g");return String(e).replace(a,function(e){return r[e]}).replace(a,function(e){return r[e]})},javascript:function(){var t=i.escapeJS,r=n?i.invert(t):t,a=n?/\\\\|\'|\\"|\\r|\\n|<\//g:/<\/|"|'|\\|\n|\r/g;return String(e).replace(a,function(e){return r[e]})},json:function(){var t=n?"parse":"stringify";return JSON[t](e)},url:function(){var t=n?"decodeURI":"encodeURI";return JSON[t](e)}};return"function"==typeof r[t]?r[t]():r.html()},getKeys:function(e){var t=[];return $.isPlainObject(e)&&$.each(e,function(e){t.push(e)}),t.sort()},hasProperty:function(e,t){return null!==e&&"object"==typeof e&&t in e},invert:function(e){var t={};return $.isPlainObject(e)&&!$.isEmptyObject(e)&&$.each(e,function(e,n){$.isArray(n)||$.isPlainObject(n)||$.isFunction(n)||(t[n]=e)}),t},js_function:function(e){var t=this,n=1,i=[];for(n;n<arguments.length;n++)i.push(t.lookup(t.rec,arguments[n]));return t[e].apply(t,i)},lookup:function(e,t){var n=this,i="";if(e.hasOwnProperty(t))i=e[t];else if(t.indexOf(".")>0)for(var r=e,a=t.split("."),o=0;null!==r&&o<a.length;)o===a.length-1&&n.hasProperty(r,a[o])&&(i=r[a[o]]),r=r[a[o++]];else n.hasProperty(e,t)&&(i=e[t]);return i},lower:function(e){return String(e).toLowerCase()},make:function(e){var t=this;if(!e||!t.html)throw new Error("wui-smarty.js - Template engine missing data and/or html template.");if(t.rec=e,null===t.compiled){var n=t.parse();return t.compiled=t.compile(),n}return t.compiled.call(t,e)},parse:function(){var e,t=this,n=0,i=t.html;return i=e=i.replace(/{\*[\w\s.,\/#!$%\^&\*;:{}=\-_`~()\[\]@]*\*}/g,""),i=i.replace(/{([\w+|:\. '"-]+)}/g,function(i,r,a){var o=r.split("|"),l=o.shift(),s="";return t.build.push(e.substr(n,a-n)),n=a+r.length+2,t.build.push({key:l}),s=t.lookup(t.rec,l),s=t.applyFlags(s,o)}),t.build.push(e.substr(n)),i},trimSpecial:function(e,t,n){if(n=n||"g","string"!=typeof e||"string"!=typeof t||"string"!=typeof n)throw new TypeError("argument must be string");if(!/^[gi]*$/.test(n))throw new TypeError("wui-smarty.js - Invalid regex flags supplied '"+n.match(new RegExp("[^gi]*"))+"'");return t=t.replace(/[\[\](){}?*+\^$\\.|\-]/g,"\\$&"),e.replace(new RegExp("^["+t+"]+|["+t+"]+$",n),"")},unescape:function(e,t){return this.escape(e,t,!0)},upper:function(e){return String(e).toUpperCase()}},Wui.Combo2=function(e,t){$.extend(this,{autoLoad:!1,ddCls:"",attr:{},emptyMsg:"No Results.",field:$("<input>").attr({type:"text",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"}).addClass("wui-datalist-search"),minKeys:1,placeholder:"",searchArgName:"filter",searchLocal:!0,search_threshold:0,selected:[],showOpenButton:!0,template:null,templateFn:{},titleItem:null,valueItem:null},e,{multiSelect:!1}),this.init(t)},Wui.Combo2.prototype=$.extend(new Wui.Data,{addToDOM:function(e,t){var n=this,i=["append","prepend","before","after"];return("undefined"==typeof t||"undefined"==typeof e)&&$.each(i,function(i,r){return"undefined"!=typeof n[r]?(t=r,e=n[r],!1):void 0}),"undefined"==typeof t&&(t="append"),"undefined"==typeof e&&(e="body"),$(e)[t](n.el),n.cssByParam(),n.el},adjustDropDownSize:function(){var e,t=this,n=0;t.ddCSSRetrieved!==!0&&(t.ddWidthStyle=Wui.getStylesForElement(t.dd[0]).width,t.ddCSSRetrieved=!0),t._open||t.dd.css({visibility:"hidden"}).removeClass("wui-hidden"),t.dd.css({width:""}),isNaN(parseInt(t.ddWidthStyle))&&0!==String(t.ddWidthStyle).indexOf("calc")&&(e=t.el.innerWidth()<100?100:t.el.innerWidth(),n=t.dd.outerWidth()+Wui.getScrollbarWidth(),e=e>n?e:n,t.dd.width(e)),t._open||t.dd.addClass("wui-hidden")},argsByParam:function(){var e=this,t={},n={id:"id",name:"name",tabindex:"tabIndex",lang:"lang",title:"titleAttr"};$.each(n,function(n,i){var r=e[i];("string"==typeof r||"number"==typeof r)&&("name"==n?e.hidden_field.attr(n,r):t[n]=r)}),e.field.attr(t)},attachToElement:function(e){var t=this;t.selectTag=t.selectObserver($(e)),e.on({change:function(){t.val(e.val(),!1)}}),t.el.on("valchange",function(n,i,r){var a,o=function(){return null===r?(a=t.getItemBy(t.valueItem,r),"undefined"==typeof a?"":r):$.isPlainObject(r)?r[t.valueItem]:r}();e.val(o)})},close:function(){var e,t,n=this;n._open===!0&&(e=$("body"),t=parseInt(e.css("top")),e.removeClass("wui-combo-no-scroll").css("top",""),$(window).scrollTop(-t),n._open=!1,n.dd.addClass("wui-hidden"),void 0!==n.isBlurring&&(n.isBlurring=!0,n.field.select()))},clearSelect:function(){var e=this;e.dd.find(".wui-selected").removeClass("wui-selected"),e.selected=[],e.el.trigger($.Event("wuichange"),[e,e.el,{},e.selected])},createOptionListToggle:function(){var e,t=this;return t.showOpenButton?(e=$("<button>",{unselectable:"on",tabindex:-1}).addClass("wui-button drop-down-switch").html("").on({mousedown:function(){t.field.is(":focus")&&(t.isBlurring=!1)},click:function(e){e.preventDefault(),e.stopPropagation(),t._open===!0?t.close():t.field.mousedown()}}),t.el.addClass("wui-has-dd-btn"),e):void 0},cssByParam:function(){var e,t=this,n=t.el,i={};return t.argsByParam(),$.isEmptyObject(t.attr)||n.attr(t.attr),$.isNumeric(t.height)&&t.height>=0&&$.extend(i,{height:t.height}),$.isNumeric(t.width)&&t.width>=0&&$.extend(i,{width:t.width,flex:"none"}),Wui.isPercent(t.width)&&(e=Wui.percentToPixels(n,t.width,"width"),0!==e&&$.extend(i,{width:e,flex:"none"})),Wui.isPercent(t.height)&&(e=Wui.percentToPixels(n,t.height,"height"),0!==e&&$.extend(i,{height:e})),t.hidden&&$.extend(i,"display","none"),n.addClass(t.cls).css(i)},dataChanged:function(){this.make()},each:function(e,t){var n=this,i=0;if(!$.isArray(n.items))return!1;if(t!==!1)for(i;i<n.items.length&&e(n.items[i],i)!==!1;i++);else for(i=n.items.length;i>=0&&e(n.items[i],i)!==!1;i--);return!0},getItemBy:function(e,t){var n,i=this;return i.each(function(i){return void 0!==i.rec[e]&&i.rec[e]===t?(n=i,!1):void 0}),n},hilightText:function(e){function t(e){return e.find(".wui-highlight").each(function(){$(this).replaceWith($(this).html())}).end()}function n(i){return t(i),i.children().length?i.children(":not(.wui-datalist-disabled):visible").each(function(){n($(this))}):i.html(i.text().replace(new RegExp(e,"ig"),function(e){return'<span class="wui-highlight">'+e+"</span>"})),i}var i=this;0!==e.length?(i.dd.children(":not(.wui-datalist-disabled)").each(function(){var i=$(arguments[1]);i.text().toUpperCase().indexOf(e.toUpperCase())>=0?n(i).removeClass("wui-hidden"):t(i).addClass("wui-hidden")}),i.dd.children(".wui-datalist-disabled").addClass("wui-hidden")):i.dd.children().each(function(){var e=$(arguments[1]);t(e).removeClass("wui-hidden")}),Wui.positionItem(i.el,i.dd)},init:function(e){var t=this;if(t.engine=new Wui.Smarty($.extend({html:t.template},t.templateFn)),t.searchLocal=null===t.url||t.autoLoad===!0,t.value=t.hasOwnProperty("value")?t.value:null,t.el=$("<div>").addClass("wui-form-field").append(t._setListeners()),t.setPlaceholder(t.placeholder),t.el.append(t.createOptionListToggle()),$("body").append(t.dd=$("<ul>").addClass("wui-combo-dd wui-hidden"+t.ddCls)),"undefined"!=typeof e)e=$(e),t.idCls=Wui.id(e.attr("name")),t.hidden_field=e.after(t.el).addClass("wui-hidden").prependTo(t.el),t.attachToElement(e),t.cssByParam(),t.valueItem="value",t.titleItem="label",t.template||(t.engine.html=t.template="<li>{label}</li>"),t.setData(Wui.parseSelect(e)),t.val(e.val(),!1);else{if((!t.hasOwnProperty("template")||null===t.template||void 0===t.template)&&t.hasOwnProperty("valueItem")&&t.hasOwnProperty("titleItem")&&t.valueItem&&t.titleItem&&(t.engine.html=t.template="<li>{"+t.titleItem+"}</li>"),!t.template)throw new Error("Wui.js - valueItem and titleItem, or template, are required configs for a Combo.");t.idCls=Wui.id(),t.addToDOM(),this.getSrcData()}t.el.addClass("wui-combo "+t.idCls)},itemDeselect:function(e){var t=this;return t.selected.length>0?(e.el.removeClass("wui-selected"),t.selected=[],t.el.trigger($.Event("wuideselect"),[t,e.el,e.rec]).trigger($.Event("wuichange"),[t,e.el,e.rec,t.selected]),e):void 0},itemSelect:function(e,t){var n=this;return e&&(n.dd.find(".wui-selected").removeClass("wui-selected"),e.el.addClass("wui-selected"),n.selected=[e],n.multiSelect||t||n.el.trigger($.Event("wuiselect"),[n,e.el,e.rec]).trigger($.Event("wuichange"),[n,e.el,e.rec,n.selected])),e},make:function(){var e,t=this,n=$("<div>");return t.items=[],t.data.forEach(function(e){var i=e.disabled===!0,r={el:$(t.engine.make(e)),rec:e};t.items.push(r),n.append(r.el.data("itm",r).bind("touchstart",function(){i||(t.itemSelect($(this).data("itm")),t.isBlurring=!1)}).on({mouseenter:i?function(){}:function(){t.itemSelect($(this).data("itm"))},mousedown:i?function(){}:function(){t.isBlurring=!1},click:i?function(){}:function(){t.set(),t.field.select(),t.close()}}).addClass(i?"wui-datalist-disabled":""))}),t.dd.empty().removeClass("wui-spinner").append(n.children().unwrap()),0===t.data.length&&t.dd.html(t.emptyMsg),t.dd.off("mousedown").on("mousedown",function(){t.isBlurring=!1}),t.value&&0===t.field.val().length&&(e=t.selectBy(t.valueItem,t.value)),!e&&$.isPlainObject(t.value)&&(e=t.selectBy(t.valueItem,t.value[t.valueItem])),e&&t.set(),t.adjustDropDownSize(),t.previous&&t.previous.length&&t.hilightText(t.previous),t.items.length},open:function(){var e=this;e._open||(e._open=!0,$("body").css("top",-1*$(window).scrollTop()).addClass("wui-combo-no-scroll"),$(document).one("click:"+e.idCls,"*:not(."+e.idCls+" input)",function(t){t.target!==e.field[0]&&(e.setVal(e.value),e.close())}),e.dd.css({visibility:"hidden"}).removeClass("wui-hidden"),e.adjustDropDownSize(),Wui.positionItem(e.el,e.dd),e.dd.css("visibility",""),$.isPlainObject(e.value)&&e.getItemBy(e.valueItem,e.value[e.valueItem]),e.field.select(),e.scrollToCurrent())},scrollToCurrent:function(){var e=this,t=e.dd.find(".wui-selected:first"),n=t.offsetParent(),i=function(){var n=0;return t.prevAll().each(function(){n+=$(this).outerHeight()}),n-=e.dd.height()/2-t.outerHeight()/2}();n.animate({scrollTop:i},100)},selectBy:function(){var e=this,t=e.getItemBy.apply(e,arguments);return e.itemSelect(t)},selectByEl:function(e,t){var n,i=this;return i.itemSelect(n=$(e).data("itm")),t!==!1&&i.scrollToCurrent(),n},selectObserver:function(e){function t(){var t=e[0],i=0!==~~t.option_count?t.option_count:e.find("option").length;n.selectTag&&i!=n.total&&n.setData(Wui.parseSelect(n.selectTag)),t.observer_count=~~++t.observer_count,t.observer_count+1==i&&(t.observer_count=0,setTimeout(function(){e.trigger("change")},0))}var n=this;return e.find("option").each(function(e,n){Object.defineProperty(n,"selected",{get:function(){return this.getAttribute("selected")},set:function(e){e===!1?n.removeAttribute("selected"):n.disabled!==!0&&n.setAttribute("selected",!0),t()}})}),Object.defineProperty(e[0],"value",{get:function(){return $.valHooks.select.get(this)},set:function(e){$.valHooks.select.set(this,e)}}),e},set:function(){var e=this,t=e.selected[0];t&&(e.value!==t.rec&&e.val(t.rec),t.rec.disabled!==!0?e.field.val(t.rec[e.titleItem]):e.field.attr("placeholder",t.rec[e.titleItem])),e._open&&e.close()},_setChanged:function(e){var t=this;t.parent&&t.parent instanceof Wui.Form&&t.parent.formChange(!0,t),t.el.trigger($.Event("valchange"),[t,t.value,e])},_setListeners:function(){function e(e){var t=":visible:not(.wui-datalist-disabled)",i=1===e?":first":":last",r=1===e?"nextAll":"prevAll",a=n.selected.length?n.selected[0].el[r](t+":first"):n.dd.children(t+i),o=n.selected[0];o=n.selectByEl(a),$.isPlainObject(o)||(o=n.selectByEl(n.dd.children(t+i)))}function t(){var e=n.field[0].value,t=n.previous||void 0,i={};n.previous=e,n.searchLocal&&n.total>=n.search_threshold?n.hilightText(e):(n.clearSelect(),(e.length>=n.minKeys||0===e.length)&&n.previous!=t&&(0===e.length&&n.val(null),n.dd.addClass("wui-spinner"),i[n.searchArgName]=e,n.loadData(i)))}var n=this,i={TAB:9,ENTER:13,SHIFT:16,ESC:27,UP:38,DOWN:40};return n.field.on("keydown",function(t){if(t.stopPropagation(),t.keyCode==i.SHIFT)return!1;if(t.keyCode==i.TAB)n._open||n.set();else if(t.keyCode!=i.SHIFT&&n.open(),-1!=$.inArray(t.keyCode,[i.DOWN,i.UP,i.ENTER,i.ESC]))switch(t.preventDefault(),n.can_search=!1,t.keyCode){case i.DOWN:e(1);break;case i.UP:e(-1);break;case i.ENTER:n.set();break;case i.ESC:n.close()}else n.can_search=!0}).on("keyup",function(e){e.stopPropagation(),e.keyCode==i.ENTER&&(e.preventDefault(),n.set()),n.can_search&&-1==$.inArray(e.keyCode,[i.TAB,i.SHIFT])&&t()}).on("focus",function(e){e.stopPropagation(),n.isBlurring!==!0&&(n.selectTag&&void 0===n.isBlurring&&n.selectTag.triggerHandler("focus"),n.isBlurring=void 0,n.el.addClass("wui-fe-focus"))}).on("blur",function(){n.isBlurring!==!1&&(n.close(),n.isBlurring=void 0,n.el.removeClass("wui-fe-focus"))}).on("mousedown",function(e){$(this).is(":focus")||e.preventDefault(),n.open()})},setPlaceholder:function(e){var t=this;return t.placeholder=e,t.field.attr("placeholder",e),e},setVal:function(e){var t=this,n=$.isPlainObject(e)?e[t.valueItem]:e,i=t.selectBy(t.valueItem,n);return $.isPlainObject(i)?(t.value=i.rec,t.set(),i):void 0},getVal:function(){var e=this,t=$.isPlainObject(e.value)&&"undefined"!=typeof e.value[e.valueItem]?e.value[e.valueItem]:e.value;return t},val:function(){var e=this;if(arguments.length){var t=e.value;return e.setVal.apply(e,arguments),arguments[1]!==!1&&e._setChanged(t),arguments}return e.getVal()},getSrcData:function(){var e=this;return e.initLoaded!==!0&&e.data instanceof Array&&e.data.length>0?(e.setParams(e.params),e.initLoaded=!0,e.setData(e.data)):e.autoLoad?null!==this.url?e.loadData():e.setData(e.data):void 0}});